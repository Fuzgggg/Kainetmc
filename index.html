<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KaiNetworkMC</title>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <audio id="click-sound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_34dbee45c3.mp3"></audio>
  <style>
    :root {
      --bg-color: #f2f5fa;
      --text-color: #000;
      --card-bg: #e0ecf7;
      --accent: #00c3ff;
    }
    body.dark {
      --bg-color: #121c2e;
      --text-color: #fff;
      --card-bg: #1c273d;
      --accent: #00fcd1;
    }

    * { box-sizing: border-box; font-family: 'Rubik', sans-serif; }
    body {
      margin: 0;
      background: var(--bg-color);
      color: var(--text-color);
      transition: all 0.3s ease;
    }
    header {
      text-align: center;
      padding: 2rem 1rem;
      background: linear-gradient(135deg, var(--accent), #0ff);
      color: #000;
    }
    .join-btn {
      background: #0ff;
      padding: 1rem 2rem;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      border: none;
      box-shadow: 0 0 15px rgba(0,255,255,0.4);
      transition: transform 0.3s ease;
    }
    .join-btn:hover { transform: scale(1.05); }

    .section { max-width: 800px; margin: auto; padding: 2rem 1.5rem; }
    .rank-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }
    .rank-card {
      background: var(--card-bg);
      border: 2px solid var(--accent);
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 0 15px rgba(0,255,255,0.15);
      transition: transform 0.3s ease;
    }
    .rank-card:hover { transform: scale(1.05); }

    form, .comments {
      background: rgba(0,0,0,0.04);
      padding: 2rem;
      border-radius: 10px;
      margin-top: 2rem;
    }

    input, select, textarea, button {
      width: 100%;
      padding: 0.9rem;
      margin: 0.7rem 0;
      border-radius: 8px;
      border: none;
      font-size: 1rem;
    }

    button {
      background: var(--accent);
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s;
    }
    button:hover {
      background: #0ff;
    }
    button:active {
      transform: scale(0.96);
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .comment-item {
      background: var(--card-bg);
      padding: 1rem;
      border-radius: 8px;
      margin-top: 0.7rem;
      animation: fadeInUp 0.4s ease both;
    }

    .reply-box {
      margin-top: 1rem;
      margin-left: 1.5rem;
      border-left: 2px solid var(--accent);
      padding-left: 1rem;
    }

    .reply-form {
      margin-top: 0.5rem;
      background: rgba(0,0,0,0.05);
      padding: 0.8rem;
      border-radius: 6px;
    }

    .reply {
      background: rgba(0,0,0,0.07);
      border-radius: 6px;
      padding: 0.6rem 0.8rem;
      margin-top: 0.4rem;
    }

    .status {
      margin-top: 1rem;
      font-weight: bold;
      color: var(--text-color);
    }

    .theme-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background: var(--accent);
      color: #000;
      padding: 0.5rem 1rem;
      border-radius: 30px;
      cursor: pointer;
      z-index: 1000;
    }

    #welcomeBubble {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #0ff;
      padding: 1rem 1.2rem;
      border-radius: 10px;
      color: #000;
      font-weight: bold;
      box-shadow: 0 0 10px #0ff;
      z-index: 999;
      display: none;
    }
  </style>
</head>
<body class="dark">

<div id="welcomeBubble">👋 Selamat Datang di KaiNetworkMC!</div>
<div class="theme-toggle" onclick="toggleTheme()">🌙/☀️</div>

<header>
  <h1>KaiNetworkMC</h1>
  <p>IP: <strong>play.kainetworkmc.xyz</strong> | Port: <strong>25450</strong></p>
  <button class="join-btn" onclick="window.open('minecraft://?addExternalServer=KaiNetworkMC|play.kainetworkmc.xyz:25450')">🚀 Join Now</button>
  <div class="status" id="serverStatus">🔄 Mengecek status server...</div>
</header>

<section class="section">
  <h2>🎖️ Daftar Rank</h2>
  <div class="rank-list">
    <div class="rank-card"><h3>🥉 VIP – 15K</h3><p>/feed, /fly, /heal, /mine reset<br>Bonus: 100K</p></div>
    <div class="rank-card"><h3>🎖 MVP – 25K</h3><p>/fly, /v, /rename, /mine reset<br>Bonus: 500K</p></div>
    <div class="rank-card"><h3>🏆 LEGENDS – 40K</h3><p>/bc, /nick, /rename, /v<br>Bonus: 1JT</p></div>
    <div class="rank-card"><h3>💠 KAISTRONG – 100K</h3><p>All Commands + /sizeUI, /tp<br>Bonus: 5JT</p></div>
    <div class="rank-card"><h3>🌸 GLORY – 200K</h3><p>Full Commands + /repair, /timeUI<br>Bonus: 10JT</p></div>
  </div>

  <form onsubmit="return kirimWA()">
    <h2>🛍️ Formulir Pembelian</h2>
    <select id="rank" required>
      <option value="">Pilih Rank</option>
      <option value="VIP">VIP</option>
      <option value="MVP">MVP</option>
      <option value="LEGENDS">LEGENDS</option>
      <option value="KAISTRONG">KAISTRONG</option>
      <option value="GLORY">GLORY</option>
    </select>
    <input type="text" id="player" placeholder="Nama Player Minecraft" required>
    <select id="bayar" required>
      <option value="">Metode Pembayaran</option>
      <option value="Dana">Dana</option>
      <option value="Gopay">Gopay</option>
      <option value="ShopeePay">ShopeePay</option>
      <option value="OVO">OVO</option>
      <option value="QRIS">QRIS</option>
    </select>
    <button type="submit">💬 Beli Sekarang via WhatsApp</button>
  </form>

  <div class="comments">
    <h2>💬 Komentar Pengunjung</h2>
    <input type="text" id="nama" placeholder="Nama (opsional)">
    <textarea id="pesan" rows="3" placeholder="Tulis komentar kamu..."></textarea>
    <button onclick="kirimKomentar()">Kirim Komentar</button>
    <div id="daftarKomentar"></div>
  </div>
</section>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCf2cQuukQwHfgApcRr4NTF4xRu4wdIyqQ",
    authDomain: "kainetworkmc.firebaseapp.com",
    databaseURL: "https://kainetworkmc-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "kainetworkmc",
    storageBucket: "kainetworkmc.firebasestorage.app",
    messagingSenderId: "751130541611",
    appId: "1:751130541611:web:f2b2df86d48623d65cb46e"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function kirimWA() {
    const rank = document.getElementById("rank").value;
    const player = document.getElementById("player").value;
    const bayar = document.getElementById("bayar").value;
    if (!rank || !player || !bayar) {
      alert("Lengkapi formulir terlebih dahulu!");
      return false;
    }
    const msg = `Halo Admin, saya ingin beli Rank *${rank}* untuk player *${player}*. Pembayaran via *${bayar}*.`;
    window.open(`https://wa.me/6281252768236?text=${encodeURIComponent(msg)}`, "_blank");
    return false;
  }

  function kirimKomentar() {
    const nama = document.getElementById("nama").value || "Anonim";
    const pesan = document.getElementById("pesan").value.trim();
    if (!pesan) return;
    const ref = db.ref("komentar").push();
    ref.set({ nama, pesan, waktu: Date.now(), balasan: {} });
    document.getElementById("pesan").value = "";
  }

  function tampilKomentar() {
    const box = document.getElementById("daftarKomentar");
    db.ref("komentar").on("value", snapshot => {
      box.innerHTML = "";
      const data = snapshot.val();
      if (!data) return;
      const keys = Object.keys(data).reverse();
      keys.forEach(id => {
        const k = data[id];
        let html = `
          <div class="comment-item" data-id="${id}">
            <strong>${k.nama}</strong><br>
            <span class="pesan">${k.pesan}</span><br>
            <button onclick="editKomentar('${id}')">✏️ Edit</button>
            <button onclick="hapusKomentar('${id}')">🗑️ Hapus</button>
            <button onclick="toggleReplyForm('${id}')">💬 Balas</button>
            <div class="reply-form" id="reply-${id}" style="display:none;">
              <input type="text" placeholder="Nama kamu" id="reply-nama-${id}">
              <input type="text" placeholder="Tulis balasan..." id="reply-teks-${id}">
              <button onclick="kirimBalasan('${id}')">Kirim Balasan</button>
            </div>
            <div class="reply-box" id="replies-${id}">`;

        if (k.balasan) {
          const replyKeys = Object.keys(k.balasan);
          replyKeys.forEach(rid => {
            const b = k.balasan[rid];
            html += `<div class="reply"><strong>${b.nama}</strong>: ${b.pesan}</div>`;
          });
        }

        html += `</div></div>`;
        box.innerHTML += html;
      });
    });
  }

  function hapusKomentar(id) {
    if (confirm("Yakin hapus komentar ini?")) {
      db.ref("komentar/" + id).remove();
    }
  }

  function editKomentar(id) {
    const teks = document.querySelector(`.comment-item[data-id="${id}"] .pesan`).textContent;
    const hasil = prompt("Edit komentar:", teks);
    if (hasil !== null) {
      db.ref("komentar/" + id).update({ pesan: hasil });
    }
  }

  function toggleReplyForm(id) {
    const el = document.getElementById("reply-" + id);
    el.style.display = el.style.display === "none" ? "block" : "none";
  }

  function kirimBalasan(id) {
    const nama = document.getElementById(`reply-nama-${id}`).value || "Anonim";
    const pesan = document.getElementById(`reply-teks-${id}`).value;
    if (!pesan) return;
    const ref = db.ref("komentar/" + id + "/balasan").push();
    ref.set({ nama, pesan });
    document.getElementById(`reply-teks-${id}`).value = "";
    toggleReplyForm(id);
  }

  function toggleTheme() {
    document.body.classList.toggle("dark");
  }

  async function cekStatusServer() {
    try {
      const res = await fetch("https://api.mcstatus.io/v2/status/bedrock/play.kainetworkmc.xyz:25450");
      const data = await res.json();
      const el = document.getElementById("serverStatus");
      if (data.online) {
        el.innerHTML = `🟢 Online - ${data.players.online}/${data.players.max} pemain`;
      } else {
        el.innerHTML = `🔴 Server Offline`;
      }
    } catch (e) {
      document.getElementById("serverStatus").innerText = "⚠️ Gagal cek status server.";
    }
  }

  // Suara klik
  function playClickSound() {
    const sound = document.getElementById("click-sound");
    if (sound) sound.play();
  }

  document.querySelectorAll("button").forEach(btn => {
    btn.addEventListener("click", playClickSound);
  });

  // Tampilkan welcome bubble
  window.addEventListener("load", () => {
    const bubble = document.getElementById("welcomeBubble");
    bubble.style.display = "block";
    setTimeout(() => bubble.style.display = "none", 5000);
  });

  tampilKomentar();
  cekStatusServer();
  setInterval(cekStatusServer, 1);
</script>
</body>
</html>
